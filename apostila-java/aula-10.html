<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula 10 - Invers√£o de Depend√™ncia e Beans</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">‚Üê Voltar ao Menu</a>
            <h1>Aula 10 - Invers√£o de Depend√™ncia e Beans</h1>
            <p class="subtitle">Spring IoC, dependency injection avan√ßado</p>
        </header>

        <div class="content">
            <section class="section">
                <h2>üìö Conectando com as Aulas Anteriores</h2>
                <div class="concept-box">
                    <p>
                        Na <strong>Aula 09</strong>, voc√™ implementou a Arquitetura Hexagonal na pr√°tica. Agora vamos 
                        <strong>aprofundar no Spring IoC e Dependency Injection</strong>, entendendo como o Spring 
                        gerencia beans e como voc√™ pode configurar isso de forma avan√ßada.
                    </p>
                    <p>
                        <strong>O que voc√™ j√° sabe:</strong> Arquitetura Hexagonal, @Service, @Repository, @Autowired, 
                        Dependency Injection b√°sico
                    </p>
                    <p>
                        <strong>O que vamos aprender agora:</strong> Como o Spring IoC funciona por baixo dos panos, 
                        como configurar beans manualmente, qualifiers, profiles, e como ter controle total sobre 
                        a inje√ß√£o de depend√™ncias
                    </p>
                </div>
            </section>

            <section class="section">
                <h2>üîÑ Invers√£o de Controle (IoC)</h2>
                
                <div class="concept-box">
                    <h3>O que √© IoC?</h3>
                    <p>Invers√£o de Controle √© um princ√≠pio onde o controle de cria√ß√£o e gerenciamento de objetos 
                    √© invertido - em vez de voc√™ criar objetos, o framework (Spring) cria e gerencia para voc√™.</p>
                    
                    <ul>
                        <li><strong>Sem IoC:</strong> Voc√™ cria objetos manualmente com <code>new</code></li>
                        <li><strong>Com IoC:</strong> Spring cria e injeta objetos automaticamente</li>
                    </ul>
                </div>

                <div class="concept-box">
                    <h3>Dependency Injection (DI)</h3>
                    <p>DI √© a implementa√ß√£o de IoC - depend√™ncias s√£o injetadas em vez de criadas internamente.</p>
                    
                    <div class="code-block">
<pre>// ‚ùå SEM Dependency Injection (acoplado)
public class UsuarioService {
    private UsuarioRepository repository = new UsuarioRepository();  // Cria√ß√£o manual
}

// ‚úÖ COM Dependency Injection (desacoplado)
public class UsuarioService {
    private final UsuarioRepository repository;
    
    public UsuarioService(UsuarioRepository repository) {  // Injetado
        this.repository = repository;
    }
}</pre>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>üè∑Ô∏è Anota√ß√µes Spring</h2>
                
                <div class="concept-box">
                    <h3>@Component e Derivadas</h3>
                    <div class="code-block">
<pre>// @Component - Componente gen√©rico
@Component
public class MeuComponente {
    // Spring gerencia este bean
}

// @Service - Para camada de servi√ßo
@Service
public class UsuarioService {
    // ...
}

// @Repository - Para camada de dados
@Repository
public class UsuarioRepository {
    // ...
}

// @Controller - Para controllers web
@Controller
public class UsuarioController {
    // ...
}

// @RestController = @Controller + @ResponseBody
@RestController
public class UsuarioApiController {
    // ...
}</pre>
                    </div>
                </div>

                <div class="tip-box">
                    <strong>üí° Todas s√£o especializa√ß√µes de @Component:</strong>
                    <ul>
                        <li><code>@Service</code>, <code>@Repository</code>, <code>@Controller</code> s√£o semanticamente diferentes</li>
                        <li>Funcionalmente, todas fazem a mesma coisa: registram o bean no Spring</li>
                        <li>Use a anota√ß√£o apropriada para melhor legibilidade</li>
                    </ul>
                </div>
            </section>

            <section class="section">
                <h2>‚öôÔ∏è @Configuration e @Bean</h2>
                
                <div class="concept-box">
                    <h3>Criando Beans Customizados</h3>
                    <div class="code-block">
<pre>package com.exemplo.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.client.RestTemplate;

@Configuration
public class AppConfig {
    
    @Bean
    public RestTemplate restTemplate() {
        RestTemplate restTemplate = new RestTemplate();
        // Configura√ß√µes adicionais
        return restTemplate;
    }
    
    @Bean
    public ObjectMapper objectMapper() {
        ObjectMapper mapper = new ObjectMapper();
        mapper.findAndRegisterModules();
        mapper.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);
        return mapper;
    }
}</pre>
                    </div>
                </div>

                <div class="concept-box">
                    <h3>Beans com Depend√™ncias</h3>
                    <div class="code-block">
<pre>@Configuration
public class ServiceConfig {
    
    @Bean
    public TaskRepositoryPort taskRepository(
            TaskJpaRepository jpaRepository,
            TaskMapper mapper) {
        return new JpaTaskRepositoryAdapter(jpaRepository, mapper);
    }
    
    @Bean
    public CreateTaskUseCase createTaskUseCase(
            TaskRepositoryPort repository) {
        return new CreateTaskService(repository);
    }
}</pre>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>üîç Como o Spring Cria Beans</h2>
                
                <div class="concept-box">
                    <h3>Processo de Inicializa√ß√£o</h3>
                    <ol>
                        <li><strong>Component Scan:</strong> Spring escaneia pacotes em busca de <code>@Component</code></li>
                        <li><strong>Cria√ß√£o:</strong> Spring cria inst√¢ncias dos beans</li>
                        <li><strong>Inje√ß√£o:</strong> Spring resolve e injeta depend√™ncias</li>
                        <li><strong>Inicializa√ß√£o:</strong> Chama m√©todos <code>@PostConstruct</code></li>
                        <li><strong>Pronto:</strong> Beans dispon√≠veis para uso</li>
                    </ol>
                </div>

                <div class="concept-box">
                    <h3>Escopo de Beans</h3>
                    <div class="code-block">
<pre>// Singleton (padr√£o) - uma inst√¢ncia por aplica√ß√£o
@Service
@Scope("singleton")
public class UsuarioService {
    // ...
}

// Prototype - nova inst√¢ncia a cada inje√ß√£o
@Component
@Scope("prototype")
public class MeuComponente {
    // ...
}

// Request - uma inst√¢ncia por requisi√ß√£o HTTP
@Controller
@Scope("request")
public class MeuController {
    // ...
}</pre>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>üêõ Debug do Fluxo de Inje√ß√£o</h2>
                
                <div class="step-box">
                    <h3>Como Acompanhar a Inje√ß√£o</h3>
                    <ol>
                        <li>Coloque breakpoint no construtor do Controller</li>
                        <li>Execute em modo Debug</li>
                        <li>Observe a pilha de chamadas (Call Stack)</li>
                        <li>Veja como Spring cria e injeta depend√™ncias</li>
                    </ol>
                </div>

                <div class="concept-box">
                    <h3>Exemplo de Fluxo</h3>
                    <div class="code-block">
<pre>// 1. Spring inicia aplica√ß√£o
// 2. Encontra @RestController em TaskController
// 3. Verifica depend√™ncias: CreateTaskUseCase
// 4. Procura implementa√ß√£o: CreateTaskService
// 5. Verifica depend√™ncias: TaskRepositoryPort
// 6. Procura implementa√ß√£o: JpaTaskRepositoryAdapter
// 7. Verifica depend√™ncias: TaskJpaRepository, TaskMapper
// 8. Cria na ordem inversa:
//    - TaskMapper
//    - TaskJpaRepository (Spring Data JPA)
//    - JpaTaskRepositoryAdapter
//    - CreateTaskService
//    - TaskController
// 9. Injeta tudo e est√° pronto!</pre>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>üí° Boas Pr√°ticas</h2>
                
                <div class="tip-box">
                    <ul>
                        <li><strong>Use inje√ß√£o por construtor:</strong> Mais test√°vel e expl√≠cito</li>
                        <li><strong>Evite @Autowired em campos:</strong> Dificulta testes</li>
                        <li><strong>Use interfaces:</strong> Facilita troca de implementa√ß√µes</li>
                        <li><strong>@Configuration para beans complexos:</strong> Quando precisa de l√≥gica de cria√ß√£o</li>
                        <li><strong>Evite ciclos de depend√™ncia:</strong> A depende de B, B depende de A</li>
                        <li><strong>Use @Qualifier:</strong> Quando h√° m√∫ltiplas implementa√ß√µes</li>
                    </ul>
                </div>
            </section>

            <section class="section">
                <h2>üîß @Qualifier - M√∫ltiplas Implementa√ß√µes</h2>
                
                <div class="concept-box">
                    <h3>Quando h√° v√°rias implementa√ß√µes do mesmo port</h3>
                    <div class="code-block">
<pre>// Interface
public interface TaskRepositoryPort {
    // ...
}

// Implementa√ß√£o 1
@Repository
@Qualifier("jpa")
public class JpaTaskRepositoryAdapter implements TaskRepositoryPort {
    // ...
}

// Implementa√ß√£o 2
@Repository
@Qualifier("memory")
public class InMemoryTaskRepositoryAdapter implements TaskRepositoryPort {
    // ...
}

// Uso com @Qualifier
@Service
public class CreateTaskService {
    private final TaskRepositoryPort repository;
    
    public CreateTaskService(
            @Qualifier("jpa") TaskRepositoryPort repository) {
        this.repository = repository;  // Injeta JpaTaskRepositoryAdapter
    }
}</pre>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>‚úÖ Checklist da Aula 10</h2>
                <div class="challenge-box">
                    <p>Antes de ir para a pr√≥xima aula, certifique-se de que:</p>
                    <ul>
                        <li>‚úÖ Entendeu o que √© IoC (Invers√£o de Controle)</li>
                        <li>‚úÖ Entendeu como o Spring gerencia beans</li>
                        <li>‚úÖ Entendeu a diferen√ßa entre @Component, @Service, @Repository, @Controller</li>
                        <li>‚úÖ Entendeu como usar @Qualifier para m√∫ltiplas implementa√ß√µes</li>
                        <li>‚úÖ Entendeu como usar @Profile para diferentes ambientes</li>
                        <li>‚úÖ Criou beans customizados com @Bean e @Configuration</li>
                        <li>‚úÖ Entendeu o ciclo de vida dos beans no Spring</li>
                        <li>‚úÖ Entendeu quando usar inje√ß√£o via construtor vs campo</li>
                    </ul>
                </div>
            </section>

            <section class="section">
                <h2>üëâ Recursos Adicionais</h2>
                <div class="resources-box">
                    <a href="https://www.youtube.com/results?search_query=Spring+Dependency+Injection+Amigoscode" target="_blank" class="resource-link">
                        üé• Spring Dependency Injection ‚Äì Amigoscode (YouTube)
                    </a>
                    <a href="https://www.baeldung.com/spring-injection-lookup" target="_blank" class="resource-link">
                        üìö Baeldung - Spring Dependency Injection Guide
                    </a>
                </div>
            </section>

            <nav class="lesson-nav">
                <a href="aula-09.html" class="nav-link">‚Üê Aula Anterior</a>
                <a href="index.html" class="nav-link">Menu Principal</a>
                <a href="aula-11.html" class="nav-link">Pr√≥xima Aula ‚Üí</a>
            </nav>
        </div>
    </div>
</body>
</html>

